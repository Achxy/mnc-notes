## 0. What are Gaussian integers?

The **Gaussian integers** are the complex numbers with integer real and imaginary parts:
$$
\mathbb{Z}[i]=\{\,a+bi:\ a,b\in\mathbb{Z}\,\}.
$$

- **Units** (invertible elements) in $\mathbb{Z}[i]$ are  
  $$
  \{\pm1,\ \pm i\};
  $$
  these are exactly the elements whose multiplicative inverses are also Gaussian integers.
- Two elements $\alpha,\beta\in\mathbb{Z}[i]$ are **associates** if they differ by a unit:
  $$
  \beta\sim\alpha \iff \beta=u\alpha,\quad u\in\{\pm1,\pm i\}.
  $$

---

## 1. The norm and why it matters

Define the **norm**
$$
N:\mathbb{Z}[i]\to\mathbb{Z}_{\ge0},\qquad N(a+bi)=a^2+b^2.
$$

Key facts:

1. **Multiplicativity.**
   $$
   N(\alpha\beta)=N(\alpha)\,N(\beta).
   $$
2. **Units have norm $1$** (indeed $1^2+0^2=0^2+1^2=1$).  
   Conversely, if $N(\alpha)=1$ then $\alpha$ is a unit.
3. **Positivity.** $N(\alpha)=0$ iff $\alpha=0$.

The norm is our “size” function. It strictly decreases in the Euclidean algorithm, so the algorithm must terminate.

---

## 2. Division with remainder in $\mathbb{Z}[i]$ (Euclidean division)

**Goal.** Given $\alpha,\beta\in\mathbb{Z}[i]$ with $\beta\neq0$, find $q,r\in\mathbb{Z}[i]$ such that  
$$
\alpha=\beta q+r,\qquad N(r)<N(\beta).
$$

**Construction (rounding trick).**

1. Compute the complex quotient in $\mathbb{C}$:
   $$
   \frac{\alpha}{\beta}=x+iy\quad (x,y\in\mathbb{R}).
   $$
2. Let $m=\operatorname{round}(x)$ and $n=\operatorname{round}(y)$ (nearest integers).
3. Set $q=m+ni\in\mathbb{Z}[i]$ and $r=\alpha-\beta q$.

Then one checks
$$
N(r)\le\frac{N(\beta)}{2}<N(\beta),
$$
so this $q,r$ satisfy the Euclidean remainder condition.

**Conclusion.** $\mathbb{Z}[i]$ is a **Euclidean domain** (with Euclidean function $N$).

---

## 3. The Euclidean algorithm in $\mathbb{Z}[i]$

Given $\alpha,\beta\in\mathbb{Z}[i]$ with $\beta\neq0$:

1. Perform division with remainder:
   $$
   \alpha=\beta q_1+r_1,\qquad N(r_1)<N(\beta).
   $$
2. Replace $(\alpha,\beta)\leftarrow(\beta,r_1)$ and repeat:
   $$
   \beta=r_1 q_2+r_2,\quad N(r_2)<N(r_1),
   $$
   $$
   r_1=r_2 q_3+r_3,\quad \dots
   $$
3. Since $N(r_k)$ is a strictly decreasing sequence of nonnegative integers, the process stops with $r_{k+1}=0$.

The **last nonzero remainder** (call it $d$) is a gcd in $\mathbb{Z}[i]$.

> **Important:** gcds in $\mathbb{Z}[i]$ are only defined **up to a unit**.  
> If $d$ is a gcd, so are $\pm d$ and $\pm i\,d$.
> A common normalization is to choose the representative with $\operatorname{Im}(d)\ge0$, and if $\operatorname{Im}(d)=0$ then $\operatorname{Re}(d)\ge0$.

---

## 4. Bézout identity and Euclid’s lemma in $\mathbb{Z}[i]$

Exactly as in $\mathbb{Z}$:

- There exist $X,Y\in\mathbb{Z}[i]$ such that
  $$
  d=\gcd(\alpha,\beta)=\alpha X+\beta Y
  $$
  (obtained by back-substitution from the Euclidean algorithm).
- **Euclid’s Lemma (Gaussian version).** If $\gcd(\alpha,\beta)=1$ and $\alpha\mid \beta\gamma$, then $\alpha\mid \gamma$.

---

## 5. Worked examples of the Gaussian Euclidean algorithm

### Example A. $\gcd(5+6i,\ 3-2i)$

**Step 1.** Divide $(5+6i)$ by $(3-2i)$.

Compute the complex quotient and round:
$$
\frac{5+6i}{3-2i}=\frac{(5+6i)(3+2i)}{3^2+(-2)^2}
=\frac{15+10i+18i+12i^2}{13}
=\frac{3+28i}{13}
\approx 0.2308+2.1538\,i.
$$

Nearest integers: $m=0,\ n=2$.  
So choose $q_1=0+2i$.

Remainder:
$$
r_1=(5+6i)-(3-2i)(2i)=(5+6i)-(4+6i)=1.
$$
Already $r_1=1$ (and $N(1)=1$), so the algorithm stops.

Hence
$$
\gcd(5+6i,\ 3-2i)=1.
$$

A Bézout relation (from the last division):
$$
1=(5+6i)-2i(3-2i).
$$

### Example B. $\gcd(7-11i,\ 8-19i)$

Perform the divisions (each time, divide and round real/imag parts to nearest integers):

1) $\displaystyle \frac{7-11i}{8-19i}\approx 0.533+0.190\,i\ \leadsto\ q_1=1+0i$  
   $$
   r_1=(7-11i)-(8-19i)= -1+8i.
   $$

2) $\displaystyle \frac{8-19i}{-1+8i}\approx -2.308+0.115\,i\ \leadsto\ q_2=-2+0i$  
   $$
   r_2=(8-19i)-(-2)(-1+8i)=(8-19i)-(2-16i)=6-3i.
   $$

3) $\displaystyle \frac{-1+8i}{6-3i}\approx 1.154+0.692\,i\ \leadsto\ q_3=1+i$  
   $$
   r_3=(-1+8i)-(1+i)(6-3i)=(-1+8i)-(9+3i)=-10+5i.
   $$

4) $\displaystyle \frac{6-3i}{-10+5i}\approx -0.600+0.100\,i\ \leadsto\ q_4=-1+0i$  
   $$
   r_4=(6-3i)-(-10+5i)=16-8i=8(2-i).
   $$

5) $\displaystyle \frac{-10+5i}{16-8i}=-\tfrac{5}{8}+\tfrac{5}{16}i\ \leadsto\ q_5=-1+0i$  
   $$
   r_5=(-10+5i)-(16-8i)= -26+13i=13(-2+i).
   $$

6) $\displaystyle \frac{16-8i}{-26+13i}\approx -0.615+0.077\,i\ \leadsto\ q_6=-1+0i$  
   $$
   r_6=(16-8i)-(-26+13i)=42-21i=21(2-i).
   $$

7) $\displaystyle \frac{-26+13i}{42-21i}\approx -0.619+0.095\,i\ \leadsto\ q_7=-1+0i$  
   $$
   r_7=(-26+13i)-(42-21i)= -68+34i=34(-2+i).
   $$

From here the remainders are associates; the last nonzero remainder is a unit multiple of $(-2+i)$.  
Thus a normalized gcd is
$$
\gcd(7-11i,\ 8-19i)\ \sim\ -2+i.
$$
(Any associate such as $-1-2i$ is equally valid; gcds are defined up to $\pm1,\pm i$.)

---

## 6. Gaussian primes and rational primes

**Definition.** A nonzero nonunit $\pi\in\mathbb{Z}[i]$ is a **Gaussian prime** if its only Gaussian divisors are units and associates.

**Classification.** A rational prime $p\in\mathbb{Z}$ behaves in $\mathbb{Z}[i]$ as follows:

1. $p=2$ factors as $2=(1+i)^2$ (so $1+i$ is a Gaussian prime).
2. If $p\equiv3\pmod4$, then $p$ **remains prime** in $\mathbb{Z}[i]$.
3. If $p\equiv1\pmod4$, then $p$ **factors nontrivially** in $\mathbb{Z}[i]$:
   $$
   p=(a+bi)(a-bi)=a^2+b^2,
   $$
   with $a,b\in\mathbb{Z}$ **unique up to order and signs**.

This yields the classical **sum of two squares theorem for primes**.

---

## 7. Sums of two squares

### 7.1. Prime case

**Theorem (Fermat–Euler two-squares, prime case).**  
A rational prime $p$ can be written as
$$
p=a^2+b^2
$$
with integers $a,b$ iff $p=2$ or $p\equiv1\pmod4$.

**Reason (via $\mathbb{Z}[i]$).**

- If $p\equiv1\pmod4$, there exists $t$ with $t^2\equiv-1\pmod p$.  
  Then $p\mid (t+i)(t-i)$ in $\mathbb{Z}[i]$.  
  Since $\gcd(t+i,t-i)=1$ in $\mathbb{Z}[i]$, Euclid’s lemma forces $p$ to divide one of them, so $p=(a+bi)(a-bi)=a^2+b^2$.
- If $p\equiv3\pmod4$, then $p$ stays Gaussian prime; a factorization $p=a^2+b^2$ would give $p=(a+bi)(a-bi)$ nontrivially, contradiction (unless $a=0$ or $b=0$, which forces $p=|a|$ or $|b|$, impossible for $p\equiv3\pmod4$).

### 7.2. General composite case

**Theorem (closure).**  
If $m=a^2+b^2$ and $n=c^2+d^2$, then
$$
mn=(ac\mp bd)^2+(ad\pm bc)^2.
$$
(Use $(a+bi)(c+di)$ and the multiplicative norm.)

Hence any integer whose prime factorization has all $p\equiv3\pmod4$ appearing with **even** exponents is a sum of two squares.

---

## 8. How to produce the two-square representation (algorithm)

**Input:** a prime $p\equiv1\pmod4$.

1. **Find $t$ with $t^2\equiv-1\pmod p$.**  
   (By Euler’s criterion, $t\equiv a^{\frac{p-1}{4}}\pmod p$ for a primitive root $a$, or by random search.)
2. **Compute $\gcd_{\mathbb{Z}[i]}\big(p,\ t+i\big)$.**  
   Run the Gaussian Euclidean algorithm; the gcd will be a factor $a+bi$ with
   $$
   p=N(a+bi)=a^2+b^2.
   $$
3. Output $(a,b)$ (normalize signs/order as desired).

---

## 9. Worked two-squares examples

### Example 1: $p=29\equiv1\pmod4$

A suitable $t$ is $t=12$ since $12^2=144\equiv-1\pmod{29}$.

Compute $\gcd_{\mathbb{Z}[i]}(29,\ 12+i)$; one finds
$$
29=(5+2i)(5-2i)=5^2+2^2.
$$

### Example 2: $p=12277\equiv1\pmod4$ 

One $t$ with $t^2\equiv-1\pmod{12277}$ is $t=4277$.

Compute $\gcd_{\mathbb{Z}[i]}(12277,\ 4277+i)$ via the Gaussian Euclidean algorithm (back-substituting gives a factor):
$$
12277=(66+89i)(66-89i)=66^2+89^2.
$$

So the requested representation is
$$
12277=89^2+66^2.
$$

(Both $(66,89)$ and $(89,66)$ are correct; order/signs are irrelevant.)

---

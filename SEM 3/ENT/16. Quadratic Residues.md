## 1. Quadratic residues mod p

Let $p$ be an odd prime.

### 1.1 Definition

For an integer $a$:

- $a$ is a **quadratic residue mod $p$** if there exists an integer $x$ such that
  $$
  x^2 \equiv a \pmod{p}.
  $$
- If $\gcd(a,p)=1$ and no such $x$ exists, then $a$ is a **quadratic non-residue mod $p$**.
- If $p\mid a$, we usually treat $a\equiv 0$ separately: $0$ is a square ($0^2$) but not a unit.

Because there are $(p-1)$ nonzero residues and the map
$$
x \mapsto x^2 \pmod{p}
$$
identifies $x$ and $-x$, there are exactly
$$
\frac{p-1}{2}
$$
nonzero quadratic residues and $\frac{p-1}{2}$ non-residues.

### 1.2 Example: $p=11$

Compute $x^2 \bmod 11$ for $x=1,\dots,10$:

- $1^2=1$,
- $2^2=4$,
- $3^2=9$,
- $4^2=16\equiv5$,
- $5^2=25\equiv3$,
- $6^2\equiv5^2\equiv3$,
- $7^2\equiv4^2\equiv5$,
- $8^2\equiv3^2\equiv9$,
- $9^2\equiv2^2\equiv4$,
- $10^2\equiv1^2\equiv1$.

Distinct nonzero residues: $1,3,4,5,9$ (five of them).  
So non-residues are $2,6,7,8,10$.

---

## 2. Legendre symbol

To package the "residue or not" information, define:

For an odd prime $p$ and integer $a$,
$$
\left(\frac{a}{p}\right) :=
\begin{cases}
\;\;0 & \text{if } p\mid a,\\[4pt]
\;\;1 & \text{if } a \text{ is a quadratic residue mod } p \text{ and } p\nmid a,\\[4pt]
-1 & \text{if } a \text{ is a non-residue mod } p.
\end{cases}
$$

Key points:

1. It depends only on $a \bmod p$.
2. It is a complete "square / non-square" indicator among units modulo $p$.

We now build its toolkit from the ground up.

---

## 3. Basic properties of the Legendre symbol

Let $p$ be an odd prime.

### 3.1 Dependence only on residue class

If $a\equiv b\pmod{p}$ then
$$
\left(\frac{a}{p}\right) = \left(\frac{b}{p}\right).
$$

Reason: $a\equiv b$ so $p\mid a$ iff $p\mid b$, and $x^2\equiv a$ has a solution iff $x^2\equiv b$ does.

### 3.2 Multiplicativity

If $a,b$ are integers, then
$$
\left(\frac{ab}{p}\right)
=
\left(\frac{a}{p}\right)\left(\frac{b}{p}\right).
$$

Proof idea (fully explicit):

- If either $a$ or $b$ is $0$ mod $p$, both sides are $0$.
- Assume $p\nmid a,b$.
- If $a\equiv x^2$, $b\equiv y^2$ mod $p$, then $ab\equiv (xy)^2$ mod $p$ so residue times residue is residue.
- If $a$ is residue, $b$ non-residue, then $ab$ is non-residue (since otherwise dividing by $a$ would make $b$ a residue).
- Same for non-residue times residue.
- Non-residue times non-residue is residue (product of two "no" is "yes"): if $a\equiv x^2n$, $b\equiv y^2n$ with $n$ non-residue, then $ab\equiv (xy)^2n^2$; but $n^2$ is square, so $ab$ is square.

These cases match exactly the multiplication of $\{1,-1\}$.

---

## 4. Euler’s Criterion

This is the main computational link.

**Theorem (Euler’s Criterion).**  
For an odd prime $p$ and integer $a$,
$$
\left(\frac{a}{p}\right) \equiv a^{\frac{p-1}{2}} \pmod{p}.
$$

More precisely:

- if $p\mid a$, then both sides are $0$;
- if $p\nmid a$, then
  $$
  a^{\frac{p-1}{2}} \equiv
  \begin{cases}
  1 \pmod{p} & \text{iff } a \text{ is a residue},\\
  -1 \pmod{p} & \text{iff } a \text{ is a non-residue}.
  \end{cases}
  $$

### Proof (step-by-step)

1. If $p\mid a$, then $a\equiv0$ and $a^{(p-1)/2}\equiv0$; definition gives $(a/p)=0$. Done.

2. Now assume $p\nmid a$.

   Consider all nonzero residues squared:
   $$
   1^2, 2^2, \dots, \left(\frac{p-1}{2}\right)^2 \pmod{p}.
   $$
   These are the $\frac{p-1}{2}$ distinct nonzero quadratic residues.

3. Their product (each residue once) is
   $$
   R = \prod_{x=1}^{(p-1)/2} x^2
   = \left(\prod_{x=1}^{(p-1)/2} x\right)^2.
   $$

4. Multiply each residue by $a$:
   $$
   a\cdot 1^2,\, a\cdot2^2,\dots,a\cdot\left(\tfrac{p-1}{2}\right)^2.
   $$
   If $a$ is a residue, this multiset is just a permutation of the residues; if $a$ is a non-residue, this is a permutation of the non-residues. We separate the two cases.

   **Case 1: $a$ is a residue.**

   Then each $a\cdot x^2$ is a residue, and in fact every residue appears exactly once. Thus the product of all residues is unchanged by multiplying each by $a$:

   $$
   a^{\frac{p-1}{2}} \cdot R \equiv R \pmod{p}.
   $$

   Because $\gcd(R,p)=1$, we cancel $R$:
   $$
   a^{\frac{p-1}{2}} \equiv 1 \pmod{p}.
   $$

   **Case 2: $a$ is a non-residue.**

   Then each $a\cdot x^2$ is a non-residue, and this list runs through all $\frac{p-1}{2}$ non-residues.

   The product of all non-residues is:
   total product of all units divided by product of residues.

   - Product of all units modulo $p$ is
     $$
     1\cdot2\cdots(p-1) \equiv -1 \pmod{p}
     $$
     by Wilson.
   - Product of residues is $R$.

   So product of non-residues is $(-1)R^{-1}$.

   On other hand, by construction it is also
   $$
   a^{\frac{p-1}{2}} R.
   $$

   Thus
   $$
   a^{\frac{p-1}{2}} R \equiv -R^{-1} \pmod{p}.
   $$

   Multiply both sides by $R$:
   $$
   a^{\frac{p-1}{2}} R^2 \equiv -1 \pmod{p}.
   $$

   But $R^2$ is a square, hence invertible; cancel:
   $$
   a^{\frac{p-1}{2}} \equiv -1 \pmod{p}.
   $$

So in all cases $a^{(p-1)/2}$ is $1$ or $-1$ mod $p$ (or $0$ if $a\equiv0$) and matches the Legendre symbol. ▢

This gives a fast way to compute $\left(\frac{a}{p}\right)$.

---

## 5. Special values: $(-1/p)$ and $(2/p)$

### 5.1 $(-1/p)$

By Euler:
$$
\left(\frac{-1}{p}\right)
\equiv (-1)^{\frac{p-1}{2}} \pmod{p},
$$
but the right side is literally $(-1)^{(p-1)/2}$.

So
$$
\boxed{
\left(\frac{-1}{p}\right)
=
\begin{cases}
\;\;1 & \text{if } p\equiv1\pmod{4},\\
-1 & \text{if } p\equiv3\pmod{4}.
\end{cases}
}
$$

### 5.2 $(2/p)$

Use Euler again:

We know $2^{\frac{p-1}{2}} \equiv \left(\frac{2}{p}\right) \pmod{p}$ and this is $\pm1$.

A standard calculation shows
$$
\boxed{
\left(\frac{2}{p}\right)
=
(-1)^{\frac{p^2-1}{8}}
=
\begin{cases}
\;\;1 & \text{if } p\equiv1,7\pmod{8},\\
-1 & \text{if } p\equiv3,5\pmod{8}.
\end{cases}
}
$$

Sketch of why: write $p=8k+r$, use binomial expansion for $(1+1)^{(p-1)/2}$ mod $p$; coefficients except ends are multiples of $p$; solve for the sign.

These formulas match what you have scribbled: fast recognition of whether $-1$ or $2$ is a square.

---

## 6. Quadratic Reciprocity

Now the main structural law.

For distinct odd primes $p,q$:

$$
\boxed{
\left(\frac{q}{p}\right)\left(\frac{p}{q}\right)
=
(-1)^{\frac{(p-1)(q-1)}{4}}.
}
$$

Equivalently:

- If at least one of $p,q$ is $\equiv1\pmod{4}$, then
  $$
  \left(\frac{q}{p}\right) = \left(\frac{p}{q}\right).
  $$
- If both $p,q\equiv3\pmod{4}$, then
  $$
  \left(\frac{q}{p}\right) = -\left(\frac{p}{q}\right).
  $$

Together with the rules for $(-1/p)$ and $(2/p)$ and multiplicativity, this lets you evaluate any $\left(\frac{a}{p}\right)$ efficiently.

I am not reproducing a full proof here (it’s long); for exams, being able to **apply** it cleanly is the priority.

---

## 7. Sample Legendre symbol calculations

### 7.1 Example: $\left(\frac{2}{7}\right)$ and $\left(\frac{2}{11}\right)$

Using $(2/p)$ formula:

- $7\equiv7\pmod8 \Rightarrow \left(\frac{2}{7}\right)=1$ (2 is a residue mod 7).
- $11\equiv3\pmod8 \Rightarrow \left(\frac{2}{11}\right)=-1$ (2 is a non-residue mod 11).

### 7.2 Example with reciprocity

Compute $\left(\dfrac{11}{23}\right)$.

1. Neither is 2; apply quadratic reciprocity:
   - $11\equiv3\pmod4$,
   - $23\equiv3\pmod4$,
   so both $\equiv3\pmod4$.
   Hence
   $$
   \left(\frac{11}{23}\right) = -\left(\frac{23}{11}\right).
   $$

2. Reduce $23$ mod $11$: $23\equiv1$.

   So
   $$
   \left(\frac{23}{11}\right) = \left(\frac{1}{11}\right)=1.
   $$

Thus
$$
\left(\frac{11}{23}\right)=-1.
$$

This pattern is exactly how your long worked examples function.

---

## 8. Square roots modulo p

Now: solve
$$
x^2 \equiv a \pmod{p}
$$
for odd prime $p$.

### 8.1 Existence and count

- If $\left(\frac{a}{p}\right)=-1$, no solutions.
- If $\left(\frac{a}{p}\right)=1$, there are exactly two solutions: $x$ and $-x$.

Reason: If $x^2\equiv a$ and $y^2\equiv a$, then $(x-y)(x+y)\equiv0$; since $p$ is prime, $x\equiv\pm y$.

### 8.2 Easy cases

1. If $p\equiv3\pmod4$ and $\left(\dfrac{a}{p}\right)=1$, then
   $$
   x \equiv a^{\frac{p+1}{4}} \pmod{p}
   $$
   is a square root. (Check: square it and use Euler’s criterion.)

2. Sometimes brute-force or small exponent tricks suffice.

For general $p$, we use **Tonelli–Shanks algorithm**, which your notes implement in a slightly disguised but equivalent way.

---

## 9. Tonelli–Shanks Algorithm (clean version)

Goal: given odd prime $p$, and $a$ with $\left(\frac{a}{p}\right)=1$, find $x$ such that $x^2\equiv a\pmod{p}$.

### Step 0. Check trivial obstructions

Compute $a^{(p-1)/2} \bmod p$ via fast exponentiation.

- If result is $p-1$, then $(a/p)=-1$ and no solution.
- If result is $1$, continue.

### Step 1. Factor out powers of 2 from $p-1$

Write
$$
p-1 = 2^s d
$$
with $d$ odd, $s\ge1$.

### Step 2. Find a quadratic non-residue

Find some $n$ with $\left(\frac{n}{p}\right)=-1$.  
Try $n=2,3,5,\dots$ until Euler’s criterion gives $-1$.

Set
$$
z = n^d \bmod p.
$$

Then $z$ has order $2^s$ modulo $p$.

### Step 3. Initial values

Set
$$
x = a^{(d+1)/2} \bmod p,
\quad
b = a^d \bmod p,
\quad
m = s.
$$

Note:

- $x^2 \equiv a b \pmod{p}$,
- $b \equiv 1 \pmod{p}$ would already give a solution.

### Step 4. Iteration

While $b \not\equiv 1 \pmod{p}$:

1. Find the smallest integer $0\le i < m$ such that
   $$
   b^{2^i} \equiv 1 \pmod{p}.
   $$

2. Set
   $$
   t = z^{2^{m-i-1}} \bmod p.
   $$

3. Update:
   $$
   x \leftarrow x t,
   \quad
   b \leftarrow b t^2,
   \quad
   z \leftarrow t^2,
   \quad
   m \leftarrow i.
   $$

At the end, $x^2\equiv a\pmod{p}$.

This algorithm is what your notes carry out (with $g$, $q$, exponents $j_k$ etc). The structure:

- $b$ stores the "error" from being a perfect square.
- $z$ is a $2^m$-th root of unity used to correct that error bit-by-bit.

---

## 10. Example 1: square root of $302$ mod $2081$ (outline)

I will mirror your result in a structured way.
(You can follow each multiplication in your own notes; key is the scaffolding.)

1. $p=2081$ is prime; compute $p-1=2080=2^5\cdot65$.
   So $s=5$, $d=65$.

2. Check $\left(\dfrac{302}{2081}\right)=1$ via Euler:
   compute $302^{1040}\bmod2081$; in your notes it turns out to be $1$ (so we proceed).

3. Find non-residue $n$.  
   Your work effectively uses such an $n$ and arrives at a specific $z$ and $b$.
   (Their chosen values: a non-residue leading to $z=203$, etc.)

4. Run the Tonelli–Shanks steps; after the bit corrections you arrived at
   $$
   x \equiv 1292 \pmod{2081}.
   $$

5. Quick check: verify $1292^2 \equiv 302 \pmod{2081}$ by direct multiplication mod $2081$.

(Your scratch shows exactly that; the important thing here is connecting it to the algorithm.)

---

## 11. Example 2: square root of $186$ mod $401$ (outline)

1. $401$ prime, $401-1=400=2^4\cdot25$ so $s=4$, $d=25$.

2. Euler’s criterion confirms $\left(\dfrac{186}{401}\right)=1$.

3. Choose a non-residue $n$; your notes choose $n=3$ (since $(3/401)=-1$).

4. Compute:
   - $z = n^d = 3^{25} \bmod 401$,
   - $x = a^{(d+1)/2} = 186^{13} \bmod 401$,
   - $b = a^d = 186^{25} \bmod 401$.

5. Then iterate as in Tonelli–Shanks; your calculations simplify and give
   $$
   x \equiv 304 \pmod{401}
   $$
   as a square root of $186$ mod $401$.

Again, the point here is: your long computation is exactly the mechanical application of the algorithm above.

---

## 12. Practical playbook

When facing exam problems on this topic, use this sequence:

1. **Is $a$ a quadratic residue mod $p$?**
   - Compute $a^{(p-1)/2} \bmod p$.
   - If $1$: residue.
   - If $-1$: non-residue.
   - If $0$: trivial square root $x\equiv0$.

2. **Need $\left(\dfrac{a}{p}\right)$ quickly?**
   - Factor $a$ as product of primes (or small factors).
   - Use multiplicativity.
   - Use:
     - $\left(\dfrac{-1}{p}\right) = (-1)^{(p-1)/2}$.
     - $\left(\dfrac{2}{p}\right) = (-1)^{(p^2-1)/8}$.
     - Quadratic reciprocity to flip $\left(\dfrac{q}{p}\right)$ into $\left(\dfrac{p}{q}\right)$.

3. **If $(a/p)=1$ and $p\equiv3\pmod4$:**
   - Use simple formula $x\equiv a^{(p+1)/4} \pmod p$.

4. **If $(a/p)=1$ and general odd $p$:**
   - Apply Tonelli–Shanks as in Section 9.

5. **Legendre symbol exercises:**
   - Reduce numerators mod $p$.
   - Pull out factors $-1$ and $2$ using special formulas.
   - Use reciprocity systematically until the numerator is tiny.

These are exactly the conceptual pillars behind your quadratic-residue, Legendre, reciprocity, and square-root notes, now laid out from zero to hero in one coherent chain.
